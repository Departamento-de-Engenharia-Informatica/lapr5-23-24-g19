@startuml
autonumber

actor "Campus Manager" as usr

participant "HTML + CSS + JS" as view
participant "Controller" as ctrl
participant "Service" as svc
participant "dto:\nDTO" as dto

participant "HTTP Params" as params
participant "HTTP Driver" as http

participant "MD" as md

activate usr
    usr -> view : wants to list buildings between a minimum\nand maximum number of floors
    activate view
        view --> usr : requests minimum and maximum number of floors
    deactivate view

    usr -> view : provides minimum and maximum number of floors
    activate view
        view -> ctrl : onSubmit()
        activate ctrl
            ctrl --> dto** : create()
            activate dto
                dto --> ctrl : dto
            deactivate dto

            ctrl -> svc : getBuildingsByFloors(dto)
            activate svc
                svc --> params** : create()
                activate params
                    svc -> params : set(minFloors)
                    svc -> params : set(maxFloors)
                deactivate params

                svc -> http : get({baseURL}/buildings/)
                activate http
                    http -> md : GET /buildings/?minFloors={min}&maxFloors={max}
                    activate md
                        note right : see us180 documentation
                        alt success
                            md --> http : 200: buildings
                            http --> svc : observable

                            loop for each building
                                svc --> dto** : create()
                                activate dto
                                    dto --> svc : dto
                                deactivate dto
                            end

                            svc --> ctrl : dto[]
                            ctrl --> ctrl : buildings = dto[]
                            ctrl --> view : buildings
                            view --> usr : lists buildings
                        else building(s) not found
                            md --> http : 404: error
                            http --> svc : observable

                            svc --> ctrl : error
                            ctrl --> ctrl : buildings = []
                            ctrl --> view : buildings
                            view --> usr : alerts buildings not found
                        end
                    deactivate md
                deactivate http
            deactivate svc
        deactivate ctrl
    deactivate view
deactivate usr


@enduml
