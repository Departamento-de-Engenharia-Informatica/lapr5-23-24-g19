@startuml
autonumber

participant "Fleet Manager" as ui
mainframe MD
box "Back-End" #LightBlue

participant "Route" as r
participant "Controller" as ctrl
participant "Service" as svc

participant "robotType:\nRobotType" as b
participant "Mapper" as map
participant "dto:\nDTO" as dto
end box
box "Database"
database "Repository" as repo
end box

ui --> r: post(/robottypes)

    activate r
        note right: verify if user is a \nfleet manager
        alt unkown user
            r --> ui : 401: Unauthorized
        else user not authorized
            r --> ui : 403: Forbidden
        else user authorized

        r -> ctrl : createRobotType()
            activate ctrl
                ctrl -> svc : createRobotType()
                activate svc

                    svc --> b **: create()
                    activate b

                    alt robot type not created
                        svc --> ctrl : error
                        deactivate b
                        ctrl --> r : error (422)
                        r --> ui : 422: Unprocessable Content
                    else robot type created successfully
                    svc -> repo : save(robotType)
                    activate repo
                    deactivate repo

                    svc -> map : toDTO(robotType)
                    activate map
                        map --> dto **: create(robotType)
                        activate dto

                        map --> svc : dto
                        deactivate dto
                    deactivate map

                    svc --> ctrl : dto
                deactivate svc

                ctrl --> r : dto (201)
            deactivate ctrl
        r --> ui: 201: Created
    deactivate r
end
end

@enduml
