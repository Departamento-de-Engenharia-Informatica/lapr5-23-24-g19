@startuml
autonumber

participant "Route" as r
participant "Controller" as ctrl
participant "Service" as svc

participant "Mapper" as map
participant "dto:\nDTO" as dto

participant "Repository" as repo
database "DB" as db

[--> r: GET /buildings
    activate r
        r -> ctrl : getBuildings(req,res)
        activate ctrl
            ctrl -> svc : getBuildings()
            activate svc
                svc -> repo : findAll()
                activate repo
                    repo -> db : findAll()
                    activate db
                    deactivate db
                deactivate repo

                alt building not found
                    svc --> ctrl : error
                    ctrl --> r : error (404)
                    [<--r : error(404)
                else floor created successfully

                loop for each building
                    svc -> map : toDTO(building)
                    activate map
                        map --> dto** : create(floor)
                            map --> svc : dto
                    deactivate map
                end loop
                    svc --> ctrl : dto
                    ctrl --> r : dto(200)
                    [<-- r : dto(200)
                end
            deactivate svc
        deactivate ctrl
    deactivate r

@enduml
